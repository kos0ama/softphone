{"version":3,"sources":["logo.svg","App.js","reportWebVitals.js","index.js"],"names":["App","qs","queryString","parse","window","location","search","useState","gcallId","setgcallId","gparticipantId","setgparticipantId","gstate","setgstate","gpresence","setgpresence","gmuted","setgmuted","gheld","setgheld","gconversationList","setgconversationList","refinputnumber","useRef","refparticipantnumber","unlessCond","gisconnected","setgisconnected","muted","setmuted","held","setheld","isConsult","setisConsult","valinputnumber","setvalinputnumber","valparticipantnumber","setvalparticipantnumber","localState","Date","getTime","redirectUri","href","client","platformClient","ApiClient","instance","conversationsApi","ConversationsApi","notificationsApi","NotificationsApi","usersApi","UsersApi","setEnvironment","setPersistSettings","me","conversationsTopic","stationTopic","presenceTopic","routingStatusTopic","notificationChannel","conversationList","handleNotification","message","notification","JSON","data","topicName","toLowerCase","console","info","debug","eventBody","id","participants","calls","state","forEach","participant","length","ani","self","addressNormalized","attributes","additionalProperties","confined","direction","dnis","other","provider","recording","recordingState","userId","user","selfUri","peerId","peer","conversation","isConnected","some","isConversationDisconnected","presenceDefinition","systemPresence","warn","useEffect","loginImplicitGrant","then","res","log","getUsersMe","postNotificationsChannels","channel","WebSocket","connectUri","onmessage","body","putNotificationsChannelSubscriptions","catch","response","callId","participantId","patchConversationsCallParticipant","err","error","disconnect","currentMuteState","mute","currentHoldState","hold","speakTo","destination","address","postConversationsCallParticipantConsult","startConsult","className","Input","type","placeholder","value","callto","ref","val","onChange","e","target","Button","inverted","color","onClick","current","focus","phoneNumber","postConversationsCalls","MakeCall","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0ce09cd6.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React, { Component, useCallback } from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport queryString from 'query-string';\nimport logo from './logo.svg';\nimport './App.css';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { Button, Input, Label } from 'semantic-ui-react';\nimport 'semantic-ui-css/semantic.min.css';\n\n/* This requires that the react app's config be \"ejected\" and set resolve.mainFields to\n * ['jsnext:main', 'browser', 'module', 'main']\n * This tells webpack to look for the jsnext:main entry point first and use the ES6 classes in the SDK\n */\nimport platformClient from 'purecloud-platform-client-v2';\n\nconst App = () => {\n\tconst qs = queryString.parse(window.location.search);\n\n\tconst [gcallId, setgcallId] = useState([]);\n\tconst [gparticipantId, setgparticipantId] = useState([]);\n\tconst [gdnis, setgdnis] = useState([]);\n\tconst [gani, setgani] = useState([]);\n\tconst [gstate, setgstate] = useState([]);\n\tconst [gpresence, setgpresence] = useState([]);\n\tconst [gdirection, setgdirection] = useState([]);\n\tconst [gmuted, setgmuted] = useState(false);\n\tconst [gheld, setgheld] = useState(false);\n\tconst [gconversationList, setgconversationList] = useState([{}]);\n\n\tconst refinputnumber = useRef(null);\n\tconst refparticipantnumber = useRef(null);\n\tconst [unlessCond, setunlessCond] = useState(false);\n\n\tconst [gisconnected, setgisconnected] = useState(false);\n\tconst [muted, setmuted] = useState(false);\n\tconst [held, setheld] = useState(false);\n\tconst [isConsult, setisConsult] = useState(false);\n\n\tconst [valinputnumber, setvalinputnumber] = useState('');\n\tconst handleChange = (e) => setvalinputnumber(e.target.value);\n\tconst [valparticipantnumber, setvalparticipantnumber] = useState('');\n\tconst handleChange2 = (e) => setvalparticipantnumber(e.target.value);\n\n\tconst localState = new Date().getTime();\n\t//console.log(`state=${localState}`);\n\n\tconst clientId = 'd03eb90b-4753-4144-be08-da2890cfa679'; //ama_implicit トークンの暗黙的な付与（ブラウザー\n\tconst redirectUri = window.location.href;\n\tconst client = platformClient.ApiClient.instance;\n\tconst conversationsApi = new platformClient.ConversationsApi();\n\tconst notificationsApi = new platformClient.NotificationsApi();\n\tconst usersApi = new platformClient.UsersApi();\n\t// Set Genesys Cloud settings\n\tclient.setEnvironment('mypurecloud.jp');\n\tclient.setPersistSettings(true, 'test_app');\n\n\t// Set local vars\n\tlet CONVERSATION_LIST_TEMPLATE = null;\n\tlet conversationList = {};\n\tlet me,\n\t\twebSocket,\n\t\tconversationsTopic,\n\t\tstationTopic,\n\t\tpresenceTopic,\n\t\troutingStatusTopic,\n\t\tnotificationChannel;\n\n\tuseEffect(() => {\n\t\tclient\n\t\t\t.loginImplicitGrant(clientId, redirectUri, { state: localState })\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log('Logged in');\n\t\t\t\t//console.log(res);\n\t\t\t\t//console.log(\n\t\t\t\t//\tres.state === localState\n\t\t\t\t//\t\t? 'State match'\n\t\t\t\t//\t\t: `Different state: ${res.state}`\n\t\t\t\t//);\n\n\t\t\t\t// Get authenticated user's info\n\t\t\t\treturn usersApi.getUsersMe();\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log('userMe: ', res);\n\t\t\t\tme = res;\n\n\t\t\t\t// Create notification channel\n\t\t\t\treturn notificationsApi.postNotificationsChannels();\n\t\t\t})\n\t\t\t.then((channel) => {\n\t\t\t\tconsole.log('channel: ', channel);\n\t\t\t\tnotificationChannel = channel;\n\n\t\t\t\t// Set up web socket\n\t\t\t\twebSocket = new WebSocket(notificationChannel.connectUri);\n\t\t\t\twebSocket.onmessage = handleNotification;\n\n\t\t\t\t// Subscribe to authenticated user's conversations\n\t\t\t\tconversationsTopic = 'v2.users.' + me.id + '.conversations';\n\t\t\t\tstationTopic = 'v2.users.' + me.id + '.station';\n\t\t\t\tpresenceTopic = 'v2.users.' + me.id + '.presence';\n\t\t\t\troutingStatusTopic = 'v2.users.' + me.id + '.routingStatus';\n\t\t\t\t//const body2 = [{ id: conversationsTopic }];\n\t\t\t\tconst body = [\n\t\t\t\t\t{ id: conversationsTopic },\n\t\t\t\t\t{ id: stationTopic },\n\t\t\t\t\t{ id: presenceTopic },\n\t\t\t\t\t{ id: routingStatusTopic },\n\t\t\t\t];\n\t\t\t\treturn notificationsApi.putNotificationsChannelSubscriptions(\n\t\t\t\t\tnotificationChannel.id,\n\t\t\t\t\tbody\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch(function (response) {\n\t\t\t\tconsole.log(response);\n\t\t\t});\n\t}, []); // Only 1 time.\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[unlessCond]が実行されました');\n\t}, [unlessCond]); // Update if authState changes\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[gisconnected]が実行されました');\n\t\t//console.log(unlessCond);\n\t\tdisconnect(gcallId, gparticipantId);\n\t}, [gisconnected]); // Update if authState changes\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[muted]が実行されました');\n\t\t//console.log(muted);\n\t\tmute(gcallId, gparticipantId, gmuted);\n\t}, [muted]); // Update if authState changes\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[held]が実行されました');\n\t\t//console.log(held);\n\t\thold(gcallId, gparticipantId, gheld);\n\t}, [held]); // Update if authState changes\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[isConsult]が実行されました');\n\t\t//console.log(isConsult);\n\t\tstartConsult();\n\t}, [isConsult]); // Update if authState changes\n\n\tuseEffect(() => {\n\t\tconsole.debug('MainHeaderでuseEffect[gconversationList]が実行されました');\n\t\tconsole.log(gconversationList);\n\t}, [gconversationList]); // Update if authState changes\n\t//===================================================================================\n\t// FROM GENESYS\n\t//===================================================================================\n\t// Handle Websocket Function\n\tfunction handleNotification(message) {\n\t\t// Parse notification string to a JSON object\n\t\tconst notification = JSON.parse(message.data);\n\n\t\tswitch (notification.topicName.toLowerCase()) {\n\t\t\tcase 'channel.metadata':\n\t\t\t\t// Heartbeat  Discard unwanted notifications\n\t\t\t\tconsole.info('Ignoring metadata: ', notification);\n\t\t\t\treturn;\n\t\t\tcase conversationsTopic.toLowerCase():\n\t\t\t\t// Conversations\n\t\t\t\tconsole.debug('Conversation notification: ', notification);\n\t\t\t\t//--------------------\n\t\t\t\t// react state に　Copy\n\t\t\t\t//--------------------\n\t\t\t\tsetgcallId(notification.eventBody.id);\n\t\t\t\tconsole.debug('gcallId:', notification.eventBody.id);\n\t\t\t\tsetgparticipantId(notification.eventBody.participants[0].id);\n\t\t\t\tconsole.debug(\n\t\t\t\t\t'gparticipantId:',\n\t\t\t\t\tnotification.eventBody.participants[0].id\n\t\t\t\t);\n\t\t\t\tsetgheld(notification.eventBody.participants[0].calls[0].held);\n\t\t\t\tconsole.debug(\n\t\t\t\t\t'gheld:',\n\t\t\t\t\tnotification.eventBody.participants[0].calls[0].held\n\t\t\t\t);\n\t\t\t\tsetgmuted(notification.eventBody.participants[0].calls[0].muted);\n\t\t\t\tconsole.debug(\n\t\t\t\t\t'gmuted:',\n\t\t\t\t\tnotification.eventBody.participants[0].calls[0].muted\n\t\t\t\t);\n\t\t\t\t// React へ　setState\n\t\t\t\t//setgdnis(notification.eventBody.participants[0].dnis);\n\t\t\t\t//setgani(notification.eventBody.participants[0].ani);\n\t\t\t\tsetgstate(notification.eventBody.participants[0].calls[0].state);\n\t\t\t\t//setgdirection(notification.eventBody.participants[0].calls[0].direction);\n\n\t\t\t\t// See function description for explanation\n\n\t\t\t\tcopyCallPropsToParticipant(notification.eventBody);\n\n\t\t\t\t// Update conversation in list or remove it if disconnected\n\t\t\t\tif (isConversationDisconnected(notification.eventBody)) {\n\t\t\t\t\tdelete conversationList[notification.eventBody.id];\n\t\t\t\t} else {\n\t\t\t\t\tconversationList[notification.eventBody.id] = notification.eventBody;\n\t\t\t\t\tsetgconversationList(notification.eventBody);\n\t\t\t\t}\n\t\t\t\treturn;\n\n\t\t\tcase routingStatusTopic.toLowerCase():\n\t\t\t\t// RoutingStatus\n\t\t\t\tconsole.debug('routingStatus notification: ', notification);\n\t\t\t\treturn;\n\t\t\tcase presenceTopic.toLowerCase():\n\t\t\t\t// RoutingStatus\n\t\t\t\tconsole.debug('presence notification: ', notification);\n\t\t\t\tsetgpresence(notification.eventBody.presenceDefinition.systemPresence);\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\t// Unexpected topic\n\t\t\t\tconsole.warn('Unknown notification: ', notification);\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\t/* This function copies properties from the participant's call object in a notification to the\n\t * participant object to make the participant object look the same as the response from the\n\t * conversations APIs. This isn't strictly necessary, but is helpful to maintain a consistent structure.\n\t */\n\tfunction copyCallPropsToParticipant(conversation) {\n\t\tconversation.participants.forEach((participant) => {\n\t\t\tif (!participant.calls || participant.calls.length === 0) return;\n\n\t\t\tparticipant.ani = participant.calls[0].self.addressNormalized;\n\t\t\tparticipant.attributes = participant.additionalProperties;\n\t\t\tparticipant.confined = participant.calls[0].confined;\n\t\t\tparticipant.direction = participant.calls[0].direction;\n\t\t\tparticipant.dnis = participant.calls[0].other.addressNormalized;\n\t\t\tparticipant.held = participant.calls[0].held;\n\t\t\tparticipant.muted = participant.calls[0].muted;\n\t\t\tparticipant.provider = participant.calls[0].provider;\n\t\t\tparticipant.recording = participant.calls[0].recording;\n\t\t\tparticipant.recordingState = participant.calls[0].recordingState;\n\t\t\tparticipant.state = participant.calls[0].state;\n\n\t\t\tif (participant.userId)\n\t\t\t\tparticipant.user = {\n\t\t\t\t\tid: participant.userId,\n\t\t\t\t\tselfUri: `/api/v2/users/${participant.userId}`,\n\t\t\t\t};\n\t\t\tif (participant.calls[0].peerId)\n\t\t\t\tparticipant.peer = participant.calls[0].peerId;\n\t\t});\n\t}\n\n\t// Determines if a conversation is disconnected by checking to see if all participants are disconnected\n\tfunction isConversationDisconnected(conversation) {\n\t\tlet isConnected = false;\n\t\tconversation.participants.some((participant) => {\n\t\t\tif (participant.state !== 'disconnected') {\n\t\t\t\tisConnected = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\treturn !isConnected;\n\t}\n\n\t// Mute participant\n\tfunction mute(callId, participantId, currentMuteState) {\n\t\t// Create request body, only set desired properties\n\t\tlet body = {\n\t\t\tmuted: !currentMuteState,\n\t\t};\n\n\t\t// Invoke API\n\t\tconversationsApi\n\t\t\t.patchConversationsCallParticipant(callId, participantId, body)\n\t\t\t.then(() => {\n\t\t\t\t// Result will be empty here\n\t\t\t})\n\t\t\t.catch((err) => console.error(err));\n\t}\n\n\t// Hold participant\n\tfunction hold(callId, participantId, currentHoldState) {\n\t\t// Create request body, only set desired properties\n\t\tlet body = {\n\t\t\theld: !currentHoldState,\n\t\t};\n\n\t\t// Invoke API\n\t\tconversationsApi\n\t\t\t.patchConversationsCallParticipant(callId, participantId, body)\n\t\t\t.then(() => {\n\t\t\t\t// Result will be empty here\n\t\t\t})\n\t\t\t.catch((err) => console.error(err));\n\t}\n\n\t// Disconnect participant\n\tfunction disconnect(callId, participantId) {\n\t\t// Create request body, only set desired properties\n\t\tlet body = {\n\t\t\tstate: 'disconnected',\n\t\t};\n\n\t\t// Invoke API\n\t\tconversationsApi\n\t\t\t.patchConversationsCallParticipant(callId, participantId, body)\n\t\t\t.then(() => {\n\t\t\t\t// Result will be empty here\n\t\t\t})\n\t\t\t.catch((err) => console.error(err));\n\t}\n\n\t// Initiate a consult transfer\n\tfunction startConsult() {\n\t\t//console.debug(conversationList);\n\t\tconsole.debug(gconversationList);\n\t\t//let callId = conversationList[Object.keys(conversationList)[0]].id;\n\t\t//let callId = gconversationList.id;\n\t\tlet callId = gcallId;\n\t\t// Grab the first participant, which should be the party we dialed for an outbound call\n\t\t//let participantId = conversationList[callId].participants[1].id;\n\t\tlet participantId = gparticipantId;\n\n\t\t// Create request body\n\t\tlet body = {\n\t\t\tspeakTo: 'destination',\n\t\t\tdestination: {\n\t\t\t\t//address: $('input#newparticipant').val(),\n\t\t\t\taddress: valparticipantnumber,\n\t\t\t},\n\t\t};\n\t\t// Invoke API\n\t\tconversationsApi\n\t\t\t.postConversationsCallParticipantConsult(callId, participantId, body)\n\t\t\t.then(() => {\n\t\t\t\t//$('input#newparticipant').val('');\n\t\t\t\t// We can ignore the response in this tutorial.\n\t\t\t})\n\t\t\t.catch((err) => console.error(err));\n\t}\n\n\t// Change which parties in the consult transfer are speaking\n\tfunction consultSpeakTo(speakTo) {\n\t\t//let callId = conversationList[Object.keys(conversationList)[0]].id;\n\t\tlet callId = gcallId;\n\n\t\t//grab the first participant, which should be the party we dialed for an outbound call\n\t\t//let participantId = conversationList[callId].participants[1].id;\n\t\tlet participantId = gparticipantId;\n\n\t\t// Create request body\n\t\tlet body = {\n\t\t\tspeakTo: speakTo,\n\t\t};\n\n\t\t// Invoke API\n\t\tconversationsApi\n\t\t\t.patchConversationsCallParticipantConsult(callId, participantId, body)\n\t\t\t.then(() => {\n\t\t\t\t// We can ignore the response in this tutorial.\n\t\t\t})\n\t\t\t.catch((err) => console.error(err));\n\t}\n\n\t//======================================\n\tconst MakeCall = () => {\n\t\tsetgisconnected(true);\n\t\trefinputnumber.current.focus();\n\t\t// Create request body\n\t\tlet body = {\n\t\t\tphoneNumber: valinputnumber,\n\t\t};\n\n\t\t// Invoke API\n\t\tconsole.log(body);\n\t\tconversationsApi\n\t\t\t.postConversationsCalls(body)\n\t\t\t.then(() => {})\n\t\t\t.catch((err) => console.error(err));\n\t};\n\n\t//-------------------------\n\t//======================================\n\n\t//-------------------------\n\t//-------------------------\n\n\t//-------------------------\n\t/*\n\tgdnis is {gdnis} / gani is {gani} / gstate is {gstate} / gdirection is{' '}\n\t{gdirection} /gisconnected is {gisconnected.toString()} / gcallId is{' '}\n\t{gcallId} / gparticipantId is {gparticipantId} / gmuted is{' '}\n\t{gmuted.toString()} / gheld is {gheld.toString()} / unlessCond :{' '}\n\t{unlessCond.toString()} / muted: {muted.toString()} / held:{' '}\n\t{held.toString()} / isConsult: {isConsult.toString()}\n\t*/\n\t//-------------------------\n\n\treturn (\n\t\t<div className=\"ui grid\">\n\t\t\t<div className=\"row\">\n\t\t\t\t<div className=\"grey column\">\n\t\t\t\t\t<div className=\"ui divided selection list\">\n\t\t\t\t\t\t<a className=\"item\">\n\t\t\t\t\t\t\t<div className=\"ui large green horizontal label\">Info1 </div>\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tid=\"dialstring\"\n\t\t\t\t\t\t\t\tplaceholder=\"3172222222\"\n\t\t\t\t\t\t\t\tvalue={qs.callto}\n\t\t\t\t\t\t\t\tref={refinputnumber}\n\t\t\t\t\t\t\t\tval={valinputnumber}\n\t\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{gisconnected === false && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"green\"\n\t\t\t\t\t\t\t\t\tid=\"dial\"\n\t\t\t\t\t\t\t\t\tonClick={() => MakeCall()}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tDial\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"red\"\n\t\t\t\t\t\t\t\t\tonClick={() => setgisconnected(false)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tDisconnect\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && muted === false && (\n\t\t\t\t\t\t\t\t<Button inverted color=\"green\" onClick={() => setmuted(true)}>\n\t\t\t\t\t\t\t\t\tMute\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && muted === true && (\n\t\t\t\t\t\t\t\t<Button inverted color=\"blue\" onClick={() => setmuted(false)}>\n\t\t\t\t\t\t\t\t\tunMute\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && held === false && (\n\t\t\t\t\t\t\t\t<Button inverted color=\"green\" onClick={() => setheld(true)}>\n\t\t\t\t\t\t\t\t\tHold\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && held === true && (\n\t\t\t\t\t\t\t\t<Button inverted color=\"blue\" onClick={() => setheld(false)}>\n\t\t\t\t\t\t\t\t\tunHold\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{valinputnumber}\n\t\t\t\t\t\t\t{gstate === 'disconnected' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini black circular label\">{gstate}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gstate === 'terminated' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini black circular label\">{gstate}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gstate === 'dialing' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini red circular label\">{gstate}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gstate === 'connected' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini blue circular label\">{gstate}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'AVAILABLE' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini green circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'BUSY' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini red circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'AWAY' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini pink circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'BREAK' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini orange circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'MEAL' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini orange circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'MEETING' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini red circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gpresence === 'TRAINING' && (\n\t\t\t\t\t\t\t\t<div className=\"ui mini orange circular label\">{gpresence}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a className=\"item\">\n\t\t\t\t\t\t\t<div className=\"ui large green horizontal label\">Info2 </div>\n\t\t\t\t\t\t\t{gisconnected === true && (\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tid=\"newparticipant\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"3172222222\"\n\t\t\t\t\t\t\t\t\tref={refparticipantnumber}\n\t\t\t\t\t\t\t\t\tval={valparticipantnumber}\n\t\t\t\t\t\t\t\t\tonChange={handleChange2}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\tid=\"Consult\"\n\t\t\t\t\t\t\t\t\tonClick={() => setisConsult('on')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tConsult\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{valparticipantnumber}\n\n\t\t\t\t\t\t\t{gisconnected === true && isConsult === 'on' && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\tonClick=\"consultSpeakTo('BOTH')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tBoth\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && isConsult === 'on' && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\tonClick=\"consultSpeakTo('DESTINATION')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tDestination\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && isConsult === 'on' && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\tonClick=\"consultSpeakTo('OBJECT')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tFirst Party\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{gisconnected === true && isConsult === 'on' && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tinverted\n\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\tonClick={() => setisConsult('off')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tConsult off\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default App;\n\n/*\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {};\n\n\t\t// Setup\n\t\tconst client = platformClient.ApiClient.instance;\n\t\tconst usersApi = new platformClient.UsersApi();\n\t\tclient.setPersistSettings(true, 'custom_app');\n\t\t// client.setDebugLog(console.log, 25);\n\t\tconst redirectUri = 'http://localhost:3000/';\n\t\t//const clientId = 'babbc081-0761-4f16-8f56-071aa402ebcb';\n\t\tconst clientId = 'd03eb90b-4753-4144-be08-da2890cfa679'; //ama_implicit トークンの暗黙的な付与（ブラウザー\n\t\tconst localState = new Date().getTime();\n\t\tconsole.log(`state=${localState}`);\n\t\t// Set Genesys Cloud settings\n\t\tclient.setEnvironment('mypurecloud.jp');\n\t\tclient.setPersistSettings(true, 'test_app');\n\n\t\t// Connect\n\t\tclient\n\t\t\t.loginImplicitGrant(clientId, redirectUri, { state: localState })\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log('logged in');\n\t\t\t\tconsole.log(res);\n\t\t\t\tconsole.log(\n\t\t\t\t\tres.state === localState\n\t\t\t\t\t\t? 'State match'\n\t\t\t\t\t\t: `Different state: ${res.state}`\n\t\t\t\t);\n\n\t\t\t\t// Get logged in user's info\n\t\t\t\treturn usersApi.getUsersMe();\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tthis.setState({ name: res.name });\n\t\t\t\tconsole.log(res);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\t// Handle failure response\n\t\t\t\tconsole.log(err);\n\t\t\t});\n\t}\n\n\trender() {\n\t\tconsole.log(platformClient);\n\t\treturn (\n\t\t\t<div className=\"App\">\n\t\t\t\t<header className=\"App-header\">\n\t\t\t\t\t<img src={logo} className=\"App-logo\" alt=\"logo\" />\n\t\t\t\t\t<h1 className=\"App-title\">Welcome to React {this.state.name}</h1>\n\t\t\t\t</header>\n\t\t\t\t<p className=\"App-intro\">\n\t\t\t\t\tTo get started, edit <code>src/App.js</code> and save to reload.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t);\n\t}\n}\n*/\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}