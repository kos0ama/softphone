(this.webpackJsonpsoftphone=this.webpackJsonpsoftphone||[]).push([[0],{100:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),i=n(33),a=n.n(i),s=(n(99),n(17)),r=(n.p,n(100),n(134)),l=n(118),u=(n(101),n(52)),d=n(8),f=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)([]),a=Object(s.a)(i,2),f=a[0],b=a[1],j=Object(c.useState)([]),p=Object(s.a)(j,2),h=(p[0],p[1],Object(c.useState)([])),v=Object(s.a)(h,2),O=(v[0],v[1],Object(c.useState)([])),g=Object(s.a)(O,2),C=g[0],m=g[1],S=Object(c.useState)([]),x=Object(s.a)(S,2),y=x[0],k=x[1],w=Object(c.useState)([]),B=Object(s.a)(w,2),N=(B[0],B[1],Object(c.useState)(!1)),E=Object(s.a)(N,2),I=E[0],M=E[1],T=Object(c.useState)(!1),P=Object(s.a)(T,2),H=P[0],L=P[1],D=Object(c.useState)([{}]),F=Object(s.a)(D,2),A=F[0],U=F[1],z=Object(c.useRef)(null),J=Object(c.useRef)(null),R=Object(c.useState)(!1),G=Object(s.a)(R,2),W=G[0],_=(G[1],Object(c.useState)(!1)),q=Object(s.a)(_,2),K=q[0],Q=q[1],V=Object(c.useState)(!1),X=Object(s.a)(V,2),Y=X[0],Z=X[1],$=Object(c.useState)(!1),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(!1),oe=Object(s.a)(ce,2),ie=oe[0],ae=oe[1],se=Object(c.useState)(""),re=Object(s.a)(se,2),le=re[0],ue=re[1],de=Object(c.useState)(""),fe=Object(s.a)(de,2),be=fe[0],je=fe[1],pe=(new Date).getTime(),he=window.location.href,ve=u.a.ApiClient.instance,Oe=new u.a.ConversationsApi,ge=new u.a.NotificationsApi,Ce=new u.a.UsersApi;ve.setEnvironment("mypurecloud.jp"),ve.setPersistSettings(!0,"test_app");var me,Se,xe,ye,ke,we,Be={};function Ne(e){var t=JSON.parse(e.data);switch(t.topicName.toLowerCase()){case"channel.metadata":return void console.info("Ignoring metadata: ",t);case Se.toLowerCase():return console.debug("Conversation notification: ",t),o(t.eventBody.id),console.debug("gcallId:",t.eventBody.id),b(t.eventBody.participants[0].id),console.debug("gparticipantId:",t.eventBody.participants[0].id),L(t.eventBody.participants[0].calls[0].held),console.debug("gheld:",t.eventBody.participants[0].calls[0].held),M(t.eventBody.participants[0].calls[0].muted),console.debug("gmuted:",t.eventBody.participants[0].calls[0].muted),m(t.eventBody.participants[0].calls[0].state),t.eventBody.participants.forEach((function(e){e.calls&&0!==e.calls.length&&(e.ani=e.calls[0].self.addressNormalized,e.attributes=e.additionalProperties,e.confined=e.calls[0].confined,e.direction=e.calls[0].direction,e.dnis=e.calls[0].other.addressNormalized,e.held=e.calls[0].held,e.muted=e.calls[0].muted,e.provider=e.calls[0].provider,e.recording=e.calls[0].recording,e.recordingState=e.calls[0].recordingState,e.state=e.calls[0].state,e.userId&&(e.user={id:e.userId,selfUri:"/api/v2/users/".concat(e.userId)}),e.calls[0].peerId&&(e.peer=e.calls[0].peerId))})),void(!function(e){var t=!1;return e.participants.some((function(e){if("disconnected"!==e.state)return t=!0,!0})),!t}(t.eventBody)?(Be[t.eventBody.id]=t.eventBody,U(t.eventBody)):delete Be[t.eventBody.id]);case ke.toLowerCase():return void console.debug("routingStatus notification: ",t);case ye.toLowerCase():return console.debug("presence notification: ",t),void k(t.eventBody.presenceDefinition.systemPresence);default:return void console.warn("Unknown notification: ",t)}}Object(c.useEffect)((function(){ve.loginImplicitGrant("d03eb90b-4753-4144-be08-da2890cfa679",he,{state:pe}).then((function(e){return console.log("Logged in"),Ce.getUsersMe()})).then((function(e){return console.log("userMe: ",e),me=e,ge.postNotificationsChannels()})).then((function(e){console.log("channel: ",e),we=e,new WebSocket(we.connectUri).onmessage=Ne,Se="v2.users."+me.id+".conversations",xe="v2.users."+me.id+".station",ye="v2.users."+me.id+".presence",ke="v2.users."+me.id+".routingStatus";var t=[{id:Se},{id:xe},{id:ye},{id:ke}];return ge.putNotificationsChannelSubscriptions(we.id,t)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[unlessCond]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f")}),[W]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[gisconnected]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f"),function(e,t){var n={state:"disconnected"};Oe.patchConversationsCallParticipant(e,t,n).then((function(){})).catch((function(e){return console.error(e)}))}(n,f)}),[K]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[muted]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f"),function(e,t,n){var c={muted:!n};Oe.patchConversationsCallParticipant(e,t,c).then((function(){})).catch((function(e){return console.error(e)}))}(n,f,I)}),[Y]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[held]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f"),function(e,t,n){var c={held:!n};Oe.patchConversationsCallParticipant(e,t,c).then((function(){})).catch((function(e){return console.error(e)}))}(n,f,H)}),[te]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[isConsult]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f"),function(){console.debug(A);var e=n,t=f,c={speakTo:"destination",destination:{address:be}};Oe.postConversationsCallParticipantConsult(e,t,c).then((function(){})).catch((function(e){return console.error(e)}))}()}),[ie]),Object(c.useEffect)((function(){console.debug("MainHeader\u3067useEffect[gconversationList]\u304c\u5b9f\u884c\u3055\u308c\u307e\u3057\u305f"),console.log(A)}),[A]);return Object(d.jsxs)("div",{className:"ui grid",children:[Object(d.jsx)("div",{className:"eight wide column",children:Object(d.jsxs)("div",{className:"ui divided selection list",children:[Object(d.jsxs)("a",{className:"item",children:[Object(d.jsx)("div",{className:"ui large green horizontal label",children:"Info1 "}),le,0!==C.length&&Object(d.jsx)("div",{className:"ui mini grey circular label",children:C})]}),Object(d.jsxs)("a",{className:"item",children:[Object(d.jsx)("div",{className:"ui large green horizontal label",children:"Info2 "}),be,0!==y.length&&Object(d.jsx)("div",{className:"ui mini grey circular label",children:y})]}),Object(d.jsxs)("a",{className:"item",children:[Object(d.jsx)(r.a,{type:"text",id:"dialstring",placeholder:"3172222222",ref:z,val:le,onChange:function(e){return ue(e.target.value)}}),Object(d.jsx)(l.a,{inverted:!0,color:"green",id:"dial",onClick:function(){return function(){Q(!0),z.current.focus();var e={phoneNumber:le};console.log(e),Oe.postConversationsCalls(e).then((function(){})).catch((function(e){return console.error(e)}))}()},children:"Dial"}),!0===K&&Object(d.jsxs)("div",{children:[!1===Y&&Object(d.jsx)(l.a,{inverted:!0,color:"green",onClick:function(){return Z(!0)},children:"Mute"}),!0===Y&&Object(d.jsx)(l.a,{inverted:!0,color:"blue",onClick:function(){return Z(!1)},children:"unMute"}),!1===te&&Object(d.jsx)(l.a,{inverted:!0,color:"green",onClick:function(){return ne(!0)},children:"Hold"}),!0===te&&Object(d.jsx)(l.a,{inverted:!0,color:"blue",onClick:function(){return ne(!1)},children:"unHold"}),Object(d.jsx)("label",{htmlFor:"newparticipant",children:"\u8ee2\u9001"}),Object(d.jsx)(r.a,{type:"text",id:"newparticipant",placeholder:"3172222222",ref:J,val:be,onChange:function(e){return je(e.target.value)}}),Object(d.jsx)(l.a,{inverted:!0,color:"purple",id:"Consult",onClick:function(){return ae("on")},children:"Consult"}),Object(d.jsx)(l.a,{inverted:!0,color:"red",onClick:function(){return Q(!1)},children:"Disconnect"}),"on"===ie&&Object(d.jsxs)("div",{children:[Object(d.jsx)(l.a,{inverted:!0,color:"purple",onClick:"consultSpeakTo('BOTH')",children:"Speak to Both"}),Object(d.jsx)(l.a,{inverted:!0,color:"purple",onClick:"consultSpeakTo('DESTINATION')",children:"Speak to Destination"}),Object(d.jsx)(l.a,{inverted:!0,color:"purple",onClick:"consultSpeakTo('OBJECT')",children:"Speak to First Party"}),Object(d.jsx)(l.a,{inverted:!0,color:"purple",onClick:function(){return ae("off")},children:"Consult off"})]})]})]})]})}),Object(d.jsx)("div",{className:"two wide column"})]})},b=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,136)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),i(e),a(e)}))};a.a.render(Object(d.jsx)(o.a.StrictMode,{children:Object(d.jsx)(f,{})}),document.getElementById("root")),b()},99:function(e,t,n){}},[[117,1,2]]]);
//# sourceMappingURL=main.b0f6d6da.chunk.js.map